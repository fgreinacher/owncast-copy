(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[852],{11165:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/config-storage",function(){return t(67389)}])},15976:function(e,n,t){"use strict";t.d(n,{Z:function(){return v}});var i=t(35666),a=t.n(i),r=t(85893),s=t(67294),o=t(94594),c=t(83200),l=t(78464),u=t(25964),d=t(35159);function f(e,n,t,i,a,r,s){try{var o=e[r](s),c=o.value}catch(l){return void t(l)}o.done?n(c):Promise.resolve(c).then(i,a)}function v(e){var n,t=(0,s.useState)(null),i=t[0],v=t[1],h=null,p=((0,s.useContext)(d.aC)||{}).setFieldInConfigState,g=e.apiPath,m=e.checked,b=e.reversed,x=void 0!==b&&b,j=e.configPath,k=void 0===j?"":j,N=e.disabled,y=void 0!==N&&N,w=e.fieldName,C=e.label,P=e.tip,S=e.useSubmit,E=e.onChange,Z=function(){v(null),clearTimeout(h),h=null},O=(n=a().mark((function e(n){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S){e.next=6;break}return v((0,c.kg)(c.Jk)),t=x?!n:n,e.next=5,(0,u.Si)({apiPath:g,data:{value:t},onSuccess:function(){p({fieldName:w,value:t,path:k}),v((0,c.kg)(c.zv))},onError:function(e){v((0,c.kg)(c.Un,"There was an error: ".concat(e)))}});case 5:h=setTimeout(Z,u.sI);case 6:E&&E(n);case 7:case"end":return e.stop()}}),e)})),function(){var e=this,t=arguments;return new Promise((function(i,a){var r=n.apply(e,t);function s(e){f(r,i,a,s,o,"next",e)}function o(e){f(r,i,a,s,o,"throw",e)}s(void 0)}))}),_=null!==i&&i.type===c.Jk;return(0,r.jsxs)("div",{className:"formfield-container toggleswitch-container",children:[C&&(0,r.jsx)("div",{className:"label-side",children:(0,r.jsx)("span",{className:"formfield-label",children:C})}),(0,r.jsxs)("div",{className:"input-side",children:[(0,r.jsxs)("div",{className:"input-group",children:[(0,r.jsx)(o.Z,{className:"switch field-".concat(w),loading:_,onChange:O,defaultChecked:m,checked:m,checkedChildren:"ON",unCheckedChildren:"OFF",disabled:y}),(0,r.jsx)(l.Z,{status:i})]}),(0,r.jsx)("p",{className:"field-tip",children:P})]})]})}v.defaultProps={apiPath:"",checked:!1,reversed:!1,configPath:"",disabled:!1,label:"",tip:"",useSubmit:!1,onChange:null}},67389:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return P}});var i=t(85893),a=t(17256),r=t(67294),s=t(35666),o=t.n(s),c=t(54907),l=t(71577),u=t(94184),d=t.n(u),f=t(35159),v=t(57553),h=t(25964),p=t(83200),g=t(19363),m=t(78464),b=t(19411),x=t(15976);function j(e,n,t,i,a,r,s){try{var o=e[r](s),c=o.value}catch(l){return void t(l)}o.done?n(c):Promise.resolve(c).then(i,a)}function k(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},i=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),i.forEach((function(n){k(e,n,t[n])}))}return e}var y=c.Z.Panel;function w(){var e=(0,r.useState)(null),n=e[0],t=e[1],a=(0,r.useState)(null),s=a[0],u=a[1],w=(0,r.useState)(!1),C=w[0],P=w[1],S=(0,r.useContext)(f.aC)||{},E=S.serverConfig,Z=S.setFieldInConfigState,O=(0,r.useContext)(v.k).setMessage,_=E.s3,z=_.accessKey,T=void 0===z?"":z,K=_.acl,F=void 0===K?"":K,I=_.bucket,D=void 0===I?"":I,J=_.enabled,U=void 0!==J&&J,X=_.endpoint,L=void 0===X?"":X,M=_.region,$=void 0===M?"":M,q=_.secret,A=void 0===q?"":q,B=_.servingEndpoint,G=void 0===B?"":B;if((0,r.useEffect)((function(){t({accessKey:T,acl:F,bucket:D,enabled:U,endpoint:L,region:$,secret:A,servingEndpoint:G}),P(U)}),[_]),!n)return null;var H,Q=null,R=function(){u(null),Q=null,clearTimeout(Q)},V=function(e){var i=e.fieldName,a=e.value;t(N({},n,k({},i,a)))},W=(H=o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u((0,p.kg)(p.Jk)),t=n,e.next=4,(0,h.Si)({apiPath:h.$w,data:{value:t},onSuccess:function(){Z({fieldName:"s3",value:t,path:""}),u((0,p.kg)(p.zv,"Updated.")),Q=setTimeout(R,h.sI),O("Changing your storage configuration will take place the next time you start a new stream.")},onError:function(e){u((0,p.kg)(p.Un,e)),Q=setTimeout(R,h.sI)}});case 4:case"end":return e.stop()}}),e)})),function(){var e=this,n=arguments;return new Promise((function(t,i){var a=H.apply(e,n);function r(e){j(a,t,i,r,s,"next",e)}function s(e){j(a,t,i,r,s,"throw",e)}r(void 0)}))}),Y=d()({"edit-storage-container":!0,"form-module":!0,enabled:C}),ee=function(e,n){var t=e.endpoint,i=e.accessKey,a=e.secret,r=e.bucket,s=e.region,o=e.enabled,c=e.servingEndpoint,l=e.acl;if(o){if(t&&(0,b.Z)(t)&&i&&a&&r&&s&&(o!==n.enabled||t!==n.endpoint||i!==n.accessKey||a!==n.secret||s!==n.region||!n.servingEndpoint&&""!==c||n.servingEndpoint&&c!==n.servingEndpoint||!n.acl&&""!==l||n.acl&&l!==n.acl))return!0}else if(o!==n.enabled)return!0;return!1}(n,_);return(0,i.jsxs)("div",{className:Y,children:[(0,i.jsx)("div",{className:"enable-switch",children:(0,i.jsx)(x.Z,{apiPath:"",fieldName:"enabled",label:"Storage Enabled",checked:n.enabled,onChange:function(e){P(e),V({fieldName:"enabled",value:e})}})}),(0,i.jsxs)("div",{className:"form-fields",children:[(0,i.jsx)("div",{className:"field-container",children:(0,i.jsx)(g.ZP,N({},h.zm.endpoint,{value:n.endpoint,onChange:V}))}),(0,i.jsx)("div",{className:"field-container",children:(0,i.jsx)(g.ZP,N({},h.zm.accessKey,{value:n.accessKey,onChange:V}))}),(0,i.jsx)("div",{className:"field-container",children:(0,i.jsx)(g.ZP,N({},h.zm.secret,{value:n.secret,onChange:V}))}),(0,i.jsx)("div",{className:"field-container",children:(0,i.jsx)(g.ZP,N({},h.zm.bucket,{value:n.bucket,onChange:V}))}),(0,i.jsx)("div",{className:"field-container",children:(0,i.jsx)(g.ZP,N({},h.zm.region,{value:n.region,onChange:V}))}),(0,i.jsx)(c.Z,{className:"advanced-section",children:(0,i.jsxs)(y,{header:"Optional Settings",children:[(0,i.jsx)("div",{className:"field-container",children:(0,i.jsx)(g.ZP,N({},h.zm.acl,{value:n.acl,onChange:V}))}),(0,i.jsx)("div",{className:"field-container",children:(0,i.jsx)(g.ZP,N({},h.zm.servingEndpoint,{value:n.servingEndpoint,onChange:V}))})]},"1")})]}),(0,i.jsxs)("div",{className:"button-container",children:[(0,i.jsx)(l.Z,{type:"primary",onClick:W,disabled:!ee,children:"Save"}),(0,i.jsx)(m.Z,{status:s})]})]})}var C=a.Z.Title;function P(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(C,{children:"Storage"}),(0,i.jsxs)("p",{className:"description",children:["Owncast supports optionally using external storage providers to distribute your video. Learn more about this by visiting our"," ",(0,i.jsx)("a",{href:"https://owncast.online/docs/storage/?source=admin",target:"_blank",rel:"noopener noreferrer",children:"Storage Documentation"}),"."]}),(0,i.jsx)("p",{className:"description",children:"Configuring this incorrectly will likely cause your video to be unplayable. Double check the documentation for your storage provider on how to configure the bucket you created for Owncast."}),(0,i.jsx)(w,{})]})}}},function(e){e.O(0,[473,774,888,179],(function(){return n=11165,e(e.s=n);var n}));var n=e.O();_N_E=n}]);