(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7095],{62433:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/chat/messages",function(){return n(28599)}])},28599:function(e,t,n){"use strict";n.r(t),n.d(t,{OUTCOME_TIMEOUT:function(){return T},default:function(){return C}});var s=n(47568),r=n(26042),i=n(69396),a=n(29815),u=n(70655),c=n(85893),o=n(67294),l=n(84485),d=n(71577),h=n(93626),m=n(89739),f=n(21640),p=n(94184),g=n.n(p),v=n(58091),x=n(58827),w=n(2766),y=n(94199),Z=n(99611),b=n(90420),N=function(e){var t=e.isVisible,n=e.message,a=e.setMessage;if(!n||(0,w.Qr)(n))return null;var l=null,h=(0,o.useState)(0),p=h[0],g=h[1],v=(n||{}).id;(0,o.useEffect)((function(){return function(){clearTimeout(l)}}));var N=function(){var e=(0,s.Z)((function(){var e;return(0,u.__generator)(this,(function(s){switch(s.label){case 0:return clearTimeout(l),g(0),[4,(0,x.rQ)(x.hn,{auth:!0,method:"POST",data:{visible:!t,idArray:[v]}})];case 1:return(e=s.sent()).success&&"changed"===e.message?(a((0,i.Z)((0,r.Z)({},n),{visible:!t})),g(1)):(a((0,i.Z)((0,r.Z)({},n),{visible:t})),g(-1)),l=setTimeout((function(){g(0)}),T),[2]}}))}));return function(){return e.apply(this,arguments)}}(),j=(0,c.jsx)(m.Z,{style:{color:"transparent"}});p&&(j=p>0?(0,c.jsx)(m.Z,{style:{color:"var(--ant-success)"}}):(0,c.jsx)(f.Z,{style:{color:"var(--ant-warning)"}}));var _="Click to ".concat(t?"hide":"show"," this message");return(0,c.jsxs)("div",{className:"toggle-switch ".concat(t?"":"hidden"),children:[(0,c.jsx)("span",{className:"outcome-icon",children:j}),(0,c.jsx)(y.Z,{title:_,placement:"topRight",children:(0,c.jsx)(d.Z,{shape:"circle",size:"small",type:"text",icon:t?(0,c.jsx)(Z.Z,{}):(0,c.jsx)(b.Z,{}),onClick:N})})]})},j=n(11085),_=l.Z.Title;var T=3e3;function C(){var e=(0,o.useState)([]),t=e[0],n=e[1],l=(0,o.useState)([]),p=l[0],y=l[1],Z=(0,o.useState)(!1),b=Z[0],C=Z[1],S=(0,o.useState)(null),k=S[0],E=S[1],I=(0,o.useState)(""),M=I[0],O=I[1],P=null,z=null,A=function(){var e=(0,s.Z)((function(){var e,t;return(0,u.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,(0,x.rQ)(x.WE,{auth:!0})];case 1:return e=s.sent(),(0,w.Qr)(e)?n([]):n(e),[3,3];case 2:return t=s.sent(),console.log("==== error",t),[3,3];case 3:return[2]}}))}));return function(){return e.apply(this,arguments)}}();(0,o.useEffect)((function(){return A(),z=setInterval((function(){A()}),x.NE),function(){clearTimeout(P),clearTimeout(z)}}),[]);var Q=function(e){return e.reduce((function(e,t){var n=t.user.id;return e.some((function(e){return e.text===n}))||e.push({text:n,value:n}),e}),[]).sort((function(e,t){var n=e.text.toUpperCase(),s=t.text.toUpperCase();return n<s?-1:n>s?1:0}))}(t),U={selectedRowKeys:p,onChange:function(e){y(e)}},D=function(e){var s=t.findIndex((function(t){return t.id===e.id}));t.splice(s,1,e),n((0,a.Z)(t))},H=function(){P=setTimeout((function(){E(null),O("")}),T)},V=function(){var e=(0,s.Z)((function(e){var s,o;return(0,u.__generator)(this,(function(u){switch(u.label){case 0:return C(!0),[4,(0,x.rQ)(x.hn,{auth:!0,method:"POST",data:{visible:e,idArray:p}})];case 1:return(s=u.sent()).success&&"changed"===s.message?(E((0,c.jsx)(m.Z,{})),H(),o=(0,a.Z)(t),p.map((function(n){var s=o.findIndex((function(e){return e.id===n})),a=(0,i.Z)((0,r.Z)({},t[s]),{visible:e});return o.splice(s,1,a),null})),n(o),y([])):(E((0,c.jsx)(f.Z,{})),H()),C(!1),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),F=[{title:"Time",dataIndex:"timestamp",key:"timestamp",className:"timestamp-col",defaultSortOrder:"descend",render:function(e){var t=new Date(e);return(0,v.Z)(t,"PP pp")},sorter:function(e,t){return new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime()},width:90},{title:"User",dataIndex:"user",key:"user",className:"name-col",filters:Q,onFilter:function(e,t){return t.user.id===e},sorter:function(e,t){return e.user.displayName.localeCompare(t.user.displayName)},sortDirections:["ascend","descend"],ellipsis:!0,render:function(e){var t=e.displayName;return(0,c.jsx)(j.Z,{user:e,children:t})},width:110},{title:"Message",dataIndex:"body",key:"body",className:"message-col",width:320,render:function(e){return(0,c.jsx)("div",{className:"message-contents",dangerouslySetInnerHTML:{__html:e}})}},{title:"",dataIndex:"hiddenAt",key:"hiddenAt",className:"toggle-col",filters:[{text:"Visible messages",value:!0},{text:"Hidden messages",value:!1}],onFilter:function(e,t){return t.visible===e},render:function(e,t){return(0,c.jsx)(N,{isVisible:!e,message:t,setMessage:D})},width:30}],K=g()({"bulk-editor":!0,active:p.length});return(0,c.jsxs)("div",{className:"chat-messages",children:[(0,c.jsx)(_,{children:"Chat Messages"}),(0,c.jsx)("p",{children:"Manage the messages from viewers that show up on your stream."}),(0,c.jsxs)("div",{className:K,children:[(0,c.jsx)("span",{className:"label",children:"Check multiple messages to change their visibility to: "}),(0,c.jsx)(d.Z,{type:"primary",size:"small",shape:"round",className:"button",loading:"show"===M&&b,icon:"show"===M&&k,disabled:!p.length||M&&"show"!==M,onClick:function(){O("show"),V(!0)},children:"Show"}),(0,c.jsx)(d.Z,{type:"primary",size:"small",shape:"round",className:"button",loading:"hide"===M&&b,icon:"hide"===M&&k,disabled:!p.length||M&&"hide"!==M,onClick:function(){O("hide"),V(!1)},children:"Hide"})]}),(0,c.jsx)(h.Z,{size:"small",className:"table-container",pagination:{defaultPageSize:100,showSizeChanger:!0},scroll:{y:540},rowClassName:function(e){return e.hiddenAt?"hidden":""},dataSource:t,columns:F,rowKey:function(e){return e.id},rowSelection:U})]})}}},function(e){e.O(0,[3662,8939,3903,4267,3626,8091,9764,9189,9640,9774,2888,179],(function(){return t=62433,e(e.s=t);var t}));var t=e.O();_N_E=t}]);