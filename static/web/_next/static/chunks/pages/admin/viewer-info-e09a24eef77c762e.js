(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6109],{42569:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(83946),a=n(19013),i=n(13882);function s(e,t){(0,i.Z)(2,arguments);var n=(0,a.Z)(e),s=(0,r.Z)(t);return isNaN(s)?new Date(NaN):s?(n.setDate(n.getDate()+s),n):n}function o(e,t){(0,i.Z)(2,arguments);var n=(0,r.Z)(t);return s(e,-n)}function u(e,t){(0,i.Z)(2,arguments);var n=(0,a.Z)(e),s=(0,r.Z)(t);if(isNaN(s))return new Date(NaN);if(!s)return n;var o=n.getDate(),u=new Date(n.getTime());u.setMonth(n.getMonth()+s+1,0);var c=u.getDate();return o>=c?u:(n.setFullYear(u.getFullYear(),u.getMonth(),o),n)}function c(e,t){(0,i.Z)(2,arguments);var n=(0,r.Z)(t);return u(e,-n)}function l(e,t){if((0,i.Z)(2,arguments),!t||"object"!==typeof t)return new Date(NaN);var n=t.years?(0,r.Z)(t.years):0,a=t.months?(0,r.Z)(t.months):0,s=t.weeks?(0,r.Z)(t.weeks):0,u=t.days?(0,r.Z)(t.days):0,l=t.hours?(0,r.Z)(t.hours):0,d=t.minutes?(0,r.Z)(t.minutes):0,f=t.seconds?(0,r.Z)(t.seconds):0,v=c(e,a+12*n),h=o(v,u+7*s),x=d+60*l,p=f+60*x,m=1e3*p,Z=new Date(h.getTime()-m);return Z}},52223:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/viewer-info",function(){return n(36709)}])},17675:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(85893),a=n(31877),i=n(92616),s=n.n(i),o=n(98147),u=n(60727);function c(e){var t={};return e.forEach((function(e){var n=new Date(e.time),r=(0,o.Z)(n,"H:mma");t[r]=e.value})),t}function l(e){var t=e.data,n=e.title,a=e.color,i=e.unit,s=e.dataCollections,o=e.yFlipped,l=e.yLogarithmic,d=[];t&&t.length>0&&d.push({name:n,color:a,data:c(t)}),s.forEach((function(e){d.push({name:e.name,data:c(e.data),color:e.color,dataset:e.options})}));var f={scales:{y:{reverse:!1,type:"linear"},x:{type:"time"}}};return f.scales.y.reverse=o,f.scales.y.type=l?"logarithmic":"linear",(0,r.jsx)("div",{className:"line-chart-container",children:(0,r.jsx)(u.wW,{xtitle:"Time",ytitle:n,suffix:i,legend:"bottom",color:a,data:d,download:n,library:f})})}s().use(a.Z),l.defaultProps={dataCollections:[],data:[],title:"",yFlipped:!1,yLogarithmic:!1}},21286:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(85893),a=n(84916),i=n(97910),s=n(74763),o=n(97751);function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){u(e,t,n[t])}))}return e}var l=a.Z.Text,d={title:"",value:0,prefix:null,suffix:null,color:"",progress:!1,centered:!1,formatter:null};function f(e){var t=e.title,n=e.value,a=e.prefix,s=e.suffix,o=e.color,u=n>90?"red":o,c=(0,r.jsxs)("div",{children:[a,(0,r.jsx)("div",{children:(0,r.jsx)(l,{type:"secondary",children:t})}),(0,r.jsx)("div",{children:(0,r.jsxs)(l,{type:"secondary",children:[n,s||"%"]})})]});return(0,r.jsx)(i.Z,{type:"dashboard",percent:n,width:120,strokeColor:{"0%":o,"90%":u},format:function(){return c}})}function v(e){var t=e.title,n=e.value,a=e.prefix,i=e.formatter;return(0,r.jsx)(s.Z,{title:t,value:n,prefix:a,formatter:i})}function h(e){var t=e.progress?f:v,n=e.centered?{display:"flex",alignItems:"center",justifyContent:"center"}:{};return(0,r.jsx)(o.Z,{type:"inner",children:(0,r.jsx)("div",{style:n,children:(0,r.jsx)(t,c({},e))})})}f.defaultProps=d,v.defaultProps=d,h.defaultProps=d},36709:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return _}});var r=n(34051),a=n.n(r),i=n(85893),s=n(67294),o=n(66516),u=n(84916),c=n(25968),l=n(6226),d=n(14670),f=n(11382),v=n(38504),h=n(87547),x=n(80882),p=n(19013),m=n(13882);function Z(e){(0,m.Z)(1,arguments);var t=(0,p.Z)(e),n=t.getTime();return n}function y(e){return(0,m.Z)(1,arguments),Math.floor(Z(e)/1e3)}var g=n(42569),w=n(17675),j=n(21286),b=n(21213),D=n(45938),k=n(70241);function N(e){var t=e.data,n=[{title:"User Agent",dataIndex:"userAgent",key:"userAgent",render:function(e){return(0,k.AB)(e)}},{title:"Location",dataIndex:"geo",key:"geo",render:function(e){return e?"".concat(e.regionName,", ").concat(e.countryCode):"-"}},{title:"Watch Time",dataIndex:"firstSeen",key:"firstSeen",defaultSortOrder:"ascend",render:function(e){return(0,D.Z)(new Date(e))},sorter:function(e,t){return new Date(e.firstSeen).getTime()-new Date(t.firstSeen).getTime()},sortDirections:["descend","ascend"]}];return(0,i.jsx)(b.Z,{pagination:{hideOnSinglePage:!0},className:"table-container",columns:n,dataSource:t,size:"small",rowKey:"id"})}var S=n(99519),C=n(64777);function P(e,t,n,r,a,i,s){try{var o=e[i](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,a)}function _(){var e,t=(0,s.useContext)(S.aC)||{},n=t.online,r=t.broadcaster,p=t.viewerCount,m=t.overallPeakViewerCount,Z=t.sessionPeakViewerCount;r&&r.time&&(e=new Date(r.time));var b=[{title:"Current stream",start:e},{title:"Last 12 hours",start:(0,g.Z)(new Date,{hours:12})},{title:"Last 24 hours",start:(0,g.Z)(new Date,{hours:24})},{title:"Last 7 days",start:(0,g.Z)(new Date,{days:7})},{title:"Last 30 days",start:(0,g.Z)(new Date,{days:30})},{title:"Last 3 months",start:(0,g.Z)(new Date,{months:3})},{title:"Last 6 months",start:(0,g.Z)(new Date,{months:6})}],D=(0,s.useState)(!0),k=D[0],_=D[1],O=(0,s.useState)([]),T=O[0],E=O[1],I=(0,s.useState)([]),L=I[0],M=I[1],A=(0,s.useState)(b[1]),F=A[0],V=A[1],Q=function(){var e,t=(e=a().mark((function e(){var t,n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t="".concat(C.iV,"?windowStart=").concat(y(F.start)),e.next=4,(0,C.rQ)(t);case 4:n=e.sent,E(n),_(!1),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("==== error",e.t0);case 12:return e.prev=12,e.next=15,(0,C.rQ)(C.a_);case 15:r=e.sent,M(r),e.next=22;break;case 19:e.prev=19,e.t1=e.catch(12),console.log("==== error",e.t1);case 22:case"end":return e.stop()}}),e,null,[[0,9],[12,19]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function s(e){P(i,r,a,s,o,"next",e)}function o(e){P(i,r,a,s,o,"throw",e)}s(void 0)}))});return function(){return t.apply(this,arguments)}}();(0,s.useEffect)((function(){var e=null;return Q(),n?(e=setInterval(Q,6e4),function(){clearInterval(e)}):function(){return[]}}),[n,F]);var W=function(e){var t=e.key;V(b[t])},X=(0,i.jsxs)(o.Z,{children:[n&&e&&(0,i.jsx)(o.Z.Item,{onClick:W,children:b[0].title},"0"),b.slice(1).map((function(e,t){return(0,i.jsx)(o.Z.Item,{onClick:W,children:e.title},t+1)}))]});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.Z.Title,{children:"Viewer Info"}),(0,i.jsx)("br",{}),(0,i.jsxs)(c.Z,{gutter:[16,16],justify:"space-around",children:[n&&(0,i.jsx)(l.Z,{span:8,md:8,children:(0,i.jsx)(j.Z,{title:"Current viewers",value:p.toString(),prefix:(0,i.jsx)(h.Z,{})})}),(0,i.jsx)(l.Z,{md:n?8:12,children:(0,i.jsx)(j.Z,{title:n?"Max viewers this stream":"Max viewers last stream",value:Z.toString(),prefix:(0,i.jsx)(h.Z,{})})}),(0,i.jsx)(l.Z,{md:n?8:12,children:(0,i.jsx)(j.Z,{title:"All-time max viewers",value:m.toString(),prefix:(0,i.jsx)(h.Z,{})})})]}),!T.length&&(0,i.jsx)(d.Z,{style:{marginTop:"10px"},banner:!0,message:"Please wait",description:"No viewer data has been collected yet.",type:"info"}),(0,i.jsxs)(f.Z,{spinning:!T.length||k,children:[(0,i.jsx)(v.Z,{overlay:X,trigger:["click"],children:(0,i.jsxs)("button",{type:"button",style:{float:"right",background:"transparent",border:"unset"},children:[F.title," ",(0,i.jsx)(x.Z,{})]})}),T.length>0&&(0,i.jsx)(w.Z,{title:"Viewers",data:T,color:"#2087E2",unit:""}),(0,i.jsx)(N,{data:L})]})]})}}},function(e){e.O(0,[7570,3698,1213,8147,7961,5938,7751,4763,1080,7910,9774,2888,179],(function(){return t=52223,e(e.s=t);var t}));var t=e.O();_N_E=t}]);